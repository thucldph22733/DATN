<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="POS - Bootstrap Admin Template">
    <meta name="keywords"
          content="admin, estimates, bootstrap, business, corporate, creative, invoice, html5, responsive, Projects">
    <meta name="author" content="Dreamguys - Bootstrap Admin Template">
    <meta name="robots" content="noindex, nofollow">
    <title>TeeZy Shop - Admin</title>
    <!-- Thêm các liên kết tới SweetAlert2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="shortcut icon" type="image/x-icon" href="/images/img/icon.png">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/plugins/select2/css/select2.min.css">
    <link rel="stylesheet" href="/css/animate.css">
    <link rel="stylesheet" href="/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="/plugins/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="/plugins/scrollbar/scroll.min.css">
    <link rel="stylesheet" href="/plugins/icons/feather/feather.css">
    <link rel="stylesheet" href="/plugins/icons/flags/flags.css">
    <link rel="stylesheet" href="/plugins/simpleline/simple-line-icons.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<style>
    /* CSS để điều chỉnh vị trí của thông báo */
    .invalid-feedback {
        position: absolute;
        top: 83px;
        z-index: 1050;
        display: none;
        width: 250px; /* Điều chỉnh độ rộng của thông báo */
        text-align: center;
        text-align: center;
        background-color: #dc3545; /* Màu nền */
        color: white; /* Màu chữ */
        padding: 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.875rem;
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }

    .custom-alert {
        position: fixed;
        top: 20px;
        right: 20px;
        width: auto;
        padding: 15px;
        background-color: #4caf50; /* Màu nền thông báo */
        color: white; /* Màu chữ */
        border-radius: 5px; /* Bo góc */
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* Đổ bóng */
        z-index: 9999; /* Đảm bảo thông báo ở trên cùng */
        transition: all 0.5s ease-in-out; /* Hiệu ứng chuyển động */
    }

    .custom-alert.show {
        opacity: 1;
        visibility: visible;
    }

    .custom-alert.hide {
        opacity: 0;
        visibility: hidden;
    }
</style>
<body class="mini-sidebar">
<!--<div th:replace="~{manage/a :: main}"></div>-->
<div th:replace="~{manage/activities :: main}"></div>
<!--CODE TỪ DƯỚI NÀY-->
<!--    <div th:if="${message}" class="alert alert-success custom-alert" role="alert">-->
<!--        <span th:text="${message}"></span>-->
<!--    </div>-->
<div th:if="${messageXacNhan}" class="alert alert-success custom-alert" role="alert">

    <span th:text="${messageXacNhan}"></span>
</div>

<div class="page-wrapper">
    <div class="content">
        <div class="page-header">
            <div class="page-title">
                <h4>Quản lý hóa đơn online</h4>
            </div>
        </div>
        <section class="comp-section">
            <div class="row">
                <div class="col-md-12">
                    <div class="card bg-white">
                        <div class="card-body">
                            <ul class="nav nav-tabs nav-tabs-solid nav-tabs-rounded nav-justified">

                                <li class="nav-item">
                                    <a th:class="${activeAll}"
                                       href="#solid-rounded-justified-tab1"
                                       data-bs-toggle="tab">Tổng quan</a>
                                </li>
                                <li class="nav-item">
                                    <a th:class="${cho_xac_nhan}"
                                       href="#solid-rounded-justified-tab2"
                                       data-bs-toggle="tab">Chờ xác nhận</a>
                                </li>
                                <li class="nav-item">
                                    <a th:class="${cho_lay_hang}"
                                       href="#solid-rounded-justified-tab3"
                                       data-bs-toggle="tab">Chờ lấy hàng</a>
                                </li>
                                <li class="nav-item">
                                    <a th:class="${cho_giao_hang}"
                                       href="#solid-rounded-justified-tab4"
                                       data-bs-toggle="tab">Chờ giao hàng</a>
                                </li>
                                <li class="nav-item">
                                    <a th:class="${thanh_cong}"
                                       href="#solid-rounded-justified-tab5"
                                       data-bs-toggle="tab">Thành Công</a>
                                </li>
                                <li class="nav-item">
                                    <a th:class="${huy}"
                                       href="#solid-rounded-justified-tab6"
                                       data-bs-toggle="tab">Hủy</a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <div th:class="${tabpane1}" id="solid-rounded-justified-tab1">
                                    <div class="row">


                                        <div class="col-lg-2 col-sm-6 col-12 d-flex">
                                            <div class="dash-count bg-warning">
                                                <div class="dash-counts">
                                                    <h4 th:text="${sumBillOnline}"></h4>
                                                    <h5>Tổng hóa đơn</h5>
                                                </div>
                                                <div class="dash-imgs">
                                                    <i class="fe fe-file"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-sm-6 col-12 d-flex">
                                            <div class="dash-count bg-warning">
                                                <div class="dash-counts">
                                                    <h4 th:text="${sumQuantityBaking}"></h4>
                                                    <h5>Hóa đơn thanh toán VNPay</h5>
                                                </div>
                                                <div class="dash-imgs">
                                                    <i class="fe fe-file"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-sm-6 col-12 d-flex">
                                            <div class="dash-count bg-warning">
                                                <div class="dash-counts">
                                                    <h4 th:text="${hoaDonChuaThanhToan}"></h4>
                                                    <h5>Hóa đơn chưa thanh toán</h5>
                                                </div>
                                                <div class="dash-imgs">
                                                    <i class="fe fe-file"></i>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-lg-2 col-sm-6 col-12 d-flex">
                                            <div class="dash-count das2">
                                                <div class="dash-counts">
                                                    <h4 th:text="${hoaDonChoXacNhan}"></h4>
                                                    <h5>Hóa đơn đang chờ xác nhận</h5>
                                                </div>
                                                <div class="dash-imgs">
                                                    <i class="fas fa-clock"></i>
                                                    <!-- Thay đổi lớp biểu tượng ở đây -->
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-lg-2 col-sm-6 col-12 d-flex">
                                            <div class="dash-count das2">
                                                <div class="dash-counts">
                                                    <h4 th:text="${hoaDonChoLayHang}"></h4>
                                                    <h5>Hóa đơn chờ lấy hàng</h5>
                                                </div>
                                                <div class="dash-imgs">
                                                    <i class="fe fe-truck"></i>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-lg-2 col-sm-6 col-12 d-flex">
                                            <div class="dash-count das2">
                                                <div class="dash-counts">
                                                    <h4 th:text="${hoaDonDangGiao}"></h4>
                                                    <h5>Hóa đơn đang giao</h5>
                                                </div>
                                                <div class="dash-imgs">
                                                    <i class="fas fa-shipping-fast"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-sm-6 col-12 d-flex">
                                            <div class="dash-count das3 bg-danger">
                                                <div class="dash-counts">
                                                    <h4 th:text="${hoaDonHuy}"></h4>
                                                    <h5>Hóa đơn hủy</h5>
                                                </div>
                                                <div class="dash-imgs">
                                                    <i class="fe fe-file-minus"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-sm-6 col-12 d-flex">
                                            <div class="dash-count das3 bg-primary">
                                                <div class="dash-counts">
                                                    <h4 th:text="${hoaDonDaNhan}"></h4>
                                                    <h5>Hóa đơn đã nhận</h5>
                                                </div>
                                                <div class="dash-imgs">
                                                    <i class="fe fe-file-text"></i>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h4 class="card-title">Tất cả hóa đơn</h4>
                                                </div>
                                                <div class="card-body">
                                                    <div class="table-top">
                                                        <div class="search-set">
                                                            <div class="search-path">
                                                                <a class="btn btn-filter" id="filter_search">
                                                                    <img src="/images/img/icons/filter.svg"
                                                                         alt="img">
                                                                    <span><img src="/images/img/icons/closes.svg"
                                                                               alt="img"></span>
                                                                </a>
                                                            </div>


                                                        </div>
                                                    </div>

                                                    <form method="get" th:action="@{/manage/bill/online/filter}">
                                                        <div class="card" id="filter_inputs">
                                                            <div class="card-body pb-0">
                                                                <div class="row">
                                                                    <div class="col-lg-2 col-sm-6 col-12">
                                                                        <div class="form-group">
                                                                            <select class="select" id="locTrangThai"
                                                                                    name="trangThai">
                                                                                <option>Trạng thái</option>
                                                                                <option value="Chờ thanh toán">Chờ
                                                                                    thanh toán
                                                                                </option>
                                                                                <option value="Chờ xác nhận">Chờ xác
                                                                                    nhận
                                                                                </option>
                                                                                <option value="Chờ lấy hàng">Chờ lấy
                                                                                    hàng
                                                                                </option>
                                                                                <option value="Chờ giao hàng">Chờ
                                                                                    giao hàng
                                                                                </option>
                                                                                <option value="Giao thành công">Giao
                                                                                    thành công
                                                                                </option>
                                                                                <option value="Đã Hủy">Đã Hủy
                                                                                </option>
                                                                            </select>
                                                                        </div>
                                                                    </div>

                                                                    <div class="col-lg-1 col-sm-6 col-12 ms-auto"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>

                                                    <div class="table-responsive">
                                                        <div class="vertical-scroll scroll-demo">
                                                            <table id="data-table" class="table datanew ">
                                                                <thead>
                                                                <tr>

                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        STT
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Mã Hóa Đơn
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thời gian tạo
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thanh toán
                                                                    </th>

                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Trạng thái
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Khách hàng
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng SP
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng tiền
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hành động
                                                                    </th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <th:block th:each="bill, x: ${listHoaDonOnline}">

                                                                    <tr th:unless="${bill.trangThai == 7}">
                                                                        <td th:text="${x.index}"></td>
                                                                        <td th:text="${bill.maHD}"></td>
                                                                        <td th:text="${#dates.format(bill.tgTao, 'HH:mm yyyy-MM-dd')}"></td>

                                                                        <td th:if="${bill.hinhThucThanhToan == 1 && bill.trangThai == 0}">
                                                                            Chờ thanh toán
                                                                        </td>
                                                                        <td th:if="${bill.hinhThucThanhToan == 1 && bill.trangThai == 1}">
                                                                            VNPAY
                                                                        </td>
                                                                        <td th:if="${!(bill.hinhThucThanhToan == 1 && (bill.trangThai == 0 || bill.trangThai == 1))}">
                                                                            TT khi nhận hàng
                                                                        </td>

                                                                        <td th:if="${bill.trangThai == 0 }">Chờ thanh toán
                                                                        </td>
                                                                        <td th:if="${bill.trangThai == 1 }">Chờ xác
                                                                            nhận
                                                                        </td>
                                                                        <td th:if="${bill.trangThai == 2 }">Chờ lấy
                                                                            hàng
                                                                        </td>
                                                                        <td th:if="${bill.trangThai == 3 }">Chờ giao
                                                                            hàng
                                                                        </td>

                                                                        <td th:if="${bill.trangThai == 4 }">Giao
                                                                            thành công
                                                                        </td>
                                                                        <td th:if="${bill.trangThai == 5 }">Đã Hủy
                                                                        </td>

                                                                        <td th:text="${bill.khachHang.hoTenKH}"></td>
                                                                        <td th:text="${bill.tongSP}"></td>
                                                                        <td th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 0, 'POINT')}"></td>
                                                                        <td>
                                                                            <i class="si si-eye"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#modalDetailHD' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 20px 0 20px; color: #ff9f43;"></i>
                                                                            <i class="si si-speedometer"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#modalXemLichSuThanhToan' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 20px 0 0; color: #ff9f43;"></i>
                                                                            <i class="fe fe-x"
                                                                               th:if="${bill.trangThai == 1 or bill.trangThai == 2}"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#modalHuyHoaDon' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 20px 0 0; color: #ff9f43;"></i>

                                                                            <a th:if="${bill.trangThai == 1 or bill.trangThai == 2}"
                                                                               th:href="@{/manage/changehd/online/{id}(id=${bill.idHD})}"
                                                                               class="btn btn-warning"
                                                                               style="margin: 0 20px 0 0;">
                                                                                <i class="fe fe-edit"
                                                                                   style="color: #ff9f43;"></i>
                                                                                Chỉnh sửa
                                                                            </a>


                                                                            <a th:if="${bill.trangThai == 4 or bill.trangThai == 5}"
                                                                               th:href="@{'http://localhost:8080/manage/bill/online/print/' + ${bill.idHD}}"
                                                                               onclick="window.open(this.href, '_blank'); return false;">
                                                                                <i class="fe fe-printer"
                                                                                   data-bs-toggle="tooltip" title=""
                                                                                   style="cursor: pointer; color: #ff9f43;"
                                                                                   data-bs-original-title="In hóa đơn"
                                                                                   aria-label="fe fe-printer"></i>
                                                                            </a>
                                                                        </td>
                                                                    </tr>
                                                                </th:block>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div th:class="${tabpane2}" id="solid-rounded-justified-tab2">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h4 class="card-title">Chờ xác nhận</h4>
                                                </div>
                                                <div class="card-body">
                                                    <div class="table-responsive">
                                                        <div class="vertical-scroll scroll-demo">
                                                            <table class="table  datanew ">
                                                                <thead>
                                                                <tr>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        STT
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Mã Hóa Đơn
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Nhân viên giao
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thời gian tạo
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thanh toán
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Khách hàng
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng SP
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng tiền
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Trạng thái
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hành động
                                                                    </th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>

                                                                <th:block
                                                                        th:each="bill, i: ${listHoaDonOnlineGiaoHang}">
                                                                    <tr th:unless="${bill.trangThai ==2  or bill.trangThai == 3  or bill.trangThai == 6}">

                                                                        <td th:text="${i.index}"></td>
                                                                        <td th:text="${bill.maHD}"></td>
                                                                        <td th:if="${bill.nhanVien != null}"
                                                                            th:text="${bill.nhanVien.hoTenNV}"></td>
                                                                        <td th:unless="${bill.nhanVien != null}">
                                                                            Chưa có NV
                                                                        </td>

                                                                        <td th:if="${bill.tgTao !=null}"
                                                                            th:text="${#dates.format(bill.tgTao, 'HH:mm yyyy-MM-dd')}"></td>
                                                                        <td th:unless="${bill.tgTao !=null}">
                                                                            Chưa giao
                                                                        </td>
                                                                        <td th:if="${bill.hinhThucThanhToan == 1 && bill.trangThai == 0}">
                                                                            Chờ thanh toán
                                                                        </td>
                                                                        <td th:if="${bill.hinhThucThanhToan == 1 && bill.trangThai == 1}">
                                                                            VNPAY
                                                                        </td>
                                                                        <td th:if="${!(bill.hinhThucThanhToan == 1 && (bill.trangThai == 0 || bill.trangThai == 1))}">
                                                                            TT khi nhận hàng
                                                                        </td>

                                                                        <td th:text="${bill.khachHang.hoTenKH}"></td>
                                                                        <td th:text="${bill.tongSP}"></td>
                                                                        <td th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 0, 'POINT')}"></td>
                                                                        <td th:if="${bill.trangThai == 1}">Chờ xác
                                                                            nhận
                                                                        </td>

                                                                        <td th:if="${bill.trangThai == 2}">Chờ lấy
                                                                            hàng
                                                                        </td>
                                                                        <td>
                                                                            <i class="fe fe-eye"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#viewBillGH' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 10px 0 20px;"></i>
                                                                            <a th:href="@{'/manage/bill/online/delivery/' + ${bill.idHD}}">
                                                                                <i class="fe fe-edit-3"
                                                                                   data-bs-toggle="tooltip"
                                                                                   title="Xem vận đơn"
                                                                                   style="cursor: pointer;"></i>
                                                                            </a>
                                                                            <i class="fe fe-x"
                                                                               th:if="${bill.trangThai == 1 or bill.trangThai == 2}"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#modalHuyHoaDon' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 20px 0 0; color: #ff9f43;"></i>

                                                                            <a th:if="${bill.trangThai == 1 or bill.trangThai == 2}"
                                                                               th:href="@{/manage/changehd/online/{id}(id=${bill.idHD})}"
                                                                               class="btn btn-warning"
                                                                               style="margin: 0 20px 0 0;">
                                                                                <i class="fe fe-edit"
                                                                                   style="color: #ff9f43;"></i>
                                                                                Chỉnh sửa
                                                                            </a>
                                                                        </td>
                                                                    </tr>
                                                                </th:block>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div th:class="${tabpane3}" id="solid-rounded-justified-tab3">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h4 class="card-title">Hóa đơn lấy hàng</h4>
                                                </div>
                                                <div class="card-body">
                                                    <div class="table-responsive">
                                                        <div class="vertical-scroll scroll-demo">
                                                            <table class="table  datanew ">
                                                                <thead>
                                                                <tr>

                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        STT
                                                                    </th>
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Mã Hóa Đơn
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hình thức thanh toán
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Nhân viên giao
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thời gian tạo
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Trạng thái
                                                                    </th>


                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Khách hàng
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng SP
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng tiền
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hành động
                                                                    </th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <th:block th:each="bill, i: ${listHoaDonOnline}">
                                                                    <tr th:if="${bill.trangThai == 4 or bill.trangThai == 5}">
                                                                    <tr th:if="${bill.trangThai == 2}">
                                                                        <td th:text="${i.index}"></td>
                                                                        <td th:text="${bill.maHD}"></td>

                                                                        <td th:if="${bill.hinhThucThanhToan == 1}">
                                                                            VNPAY
                                                                        </td>
                                                                        <td th:if="${bill.hinhThucThanhToan == 0}">
                                                                            TT khi nhận hàng
                                                                        </td>

                                                                        <td th:text="${bill.nhanVien.hoTenNV}"></td>
                                                                        <td th:text="${#dates.format(bill.tgTao, 'HH:mm yyyy-MM-dd')}"></td>

                                                                        <td th:if="${bill.trangThai == 2}"> Chờ lấy
                                                                            hàng
                                                                        </td>


                                                                        <td th:text="${bill.khachHang.hoTenKH}"></td>
                                                                        <td th:text="${bill.tongSP}"></td>
                                                                        <td th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 0, 'POINT')}"></td>
                                                                        <td>
                                                                            <i class="si si-speedometer"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#modalXemLichSuThanhToan' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 20px 0 0; color: #ff9f43;"></i>
                                                                            <i class="fe fe-x"
                                                                               th:if="${bill.trangThai == 1 or bill.trangThai == 2}"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#modalHuyHoaDon' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 20px 0 0; color: #ff9f43;"></i>

                                                                            <a th:if="${bill.trangThai == 1 or bill.trangThai == 2}"
                                                                               th:href="@{/manage/changehd/online/{id}(id=${bill.idHD})}"
                                                                               class="btn btn-warning"
                                                                               style="margin: 0 20px 0 0;">
                                                                                <i class="fe fe-edit"
                                                                                   style="color: #ff9f43;"></i>
                                                                                Chỉnh sửa
                                                                            </a>
                                                                        </td>

                                                                    </tr>
                                                                </th:block>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                                <div th:class="${tabpane4}" id="solid-rounded-justified-tab4">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h4 class="card-title">Hóa đơn chờ giao hàng</h4>
                                                </div>
                                                <div class="card-body">
                                                    <div class="table-responsive">
                                                        <div class="vertical-scroll scroll-demo">
                                                            <table class="table  datanew ">
                                                                <thead>
                                                                <tr>

                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        STT
                                                                    </th>
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Mã Hóa Đơn
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hình thức thanh toán
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Nhân viên giao
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thời gian tạo
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Trạng thái
                                                                    </th>


                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Khách hàng
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng SP
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng tiền
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hành động
                                                                    </th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <th:block th:each="bill, i: ${listHoaDonOnline}">
                                                                    <tr th:if="${bill.trangThai == 3}">


                                                                        <td th:text="${i.index}"></td>
                                                                        <td th:text="${bill.maHD}"></td>

                                                                        <td th:if="${bill.hinhThucThanhToan == 1}">
                                                                            VNPAY
                                                                        </td>
                                                                        <td th:if="${bill.hinhThucThanhToan == 0}">
                                                                            TT khi nhận hàng
                                                                        </td>
                                                                        <td th:text="${bill.nhanVien.hoTenNV}"></td>
                                                                        <td th:text="${#dates.format(bill.tgTao, 'HH:mm yyyy-MM-dd')}"></td>

                                                                        <td th:if="${bill.trangThai == 3}"> Chờ giao
                                                                            hàng
                                                                        </td>


                                                                        <td th:text="${bill.khachHang.hoTenKH}"></td>
                                                                        <td th:text="${bill.tongSP}"></td>
                                                                        <td th:text="${bill.tongSP}"></td>
                                                                        <td th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 0, 'POINT')}"></td>
                                                                        <td>
                                                                            <i class="si si-speedometer"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#modalXemLichSuThanhToan' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 20px 0 0; color: #ff9f43;"></i>
                                                                        </td>
                                                                    </tr>
                                                                </th:block>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                                <div th:class="${tabpane5}" id="solid-rounded-justified-tab5">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h4 class="card-title">Hóa đơn giao thành công</h4>
                                                </div>
                                                <div class="card-body">
                                                    <div class="table-responsive">
                                                        <div class="vertical-scroll scroll-demo">
                                                            <table class="table  datanew ">
                                                                <thead>
                                                                <tr>

                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        STT
                                                                    </th>
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Mã Hóa Đơn
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hình thức thanh toán
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Nhân viên giao
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thời gian tạo
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Trạng thái
                                                                    </th>


                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Khách hàng
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng SP
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng tiền
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thời gian TT
                                                                    </th>

                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hành động
                                                                    </th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <th:block th:each="bill, i: ${listHoaDonOnline}">
                                                                    <tr th:if="${bill.trangThai == 4}">


                                                                        <td th:text="${i.index}"></td>
                                                                        <td th:text="${bill.maHD}"></td>

                                                                        <td th:if="${bill.hinhThucThanhToan == 1}">
                                                                            VNPAY
                                                                        </td>
                                                                        <td th:if="${bill.hinhThucThanhToan == 0}">
                                                                            TT khi nhận hàng
                                                                        </td>
                                                                        <td th:text="${bill.nhanVien.hoTenNV}"></td>
                                                                        <td th:text="${#dates.format(bill.tgTao, 'HH:mm yyyy-MM-dd')}"></td>

                                                                        <td th:if="${bill.trangThai == 4}"> Giao
                                                                            thành công
                                                                        </td>


                                                                        <td th:text="${bill.khachHang.hoTenKH}"></td>
                                                                        <td th:text="${bill.tongSP}"></td>
                                                                        <td th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 0, 'POINT')}"></td>
                                                                        <td th:if="${bill.tgThanhToan != null}"
                                                                            th:text="${#dates.format(bill.tgThanhToan, 'HH:mm yyyy-MM-dd')}"></td>
                                                                        <td th:if="${bill.tgThanhToan == null}">Chưa
                                                                            có
                                                                        </td>
                                                                        <td>
                                                                            <i class="si si-speedometer"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#modalXemLichSuThanhToan' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 20px 0 0; color: #ff9f43;"></i>
                                                                        </td>
                                                                    </tr>
                                                                </th:block>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                                <div th:class="${tabpane6}" id="solid-rounded-justified-tab6">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="card">
                                                <div class="card-header">
                                                    <h4 class="card-title">Hóa đơn hủy</h4>
                                                </div>
                                                <div class="card-body">
                                                    <div class="table-responsive">
                                                        <div class="vertical-scroll scroll-demo">
                                                            <table class="table  datanew ">
                                                                <thead>
                                                                <tr>

                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        STT
                                                                    </th>
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Mã Hóa Đơn
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hình thức thanh toán
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Nhân viên giao
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thời gian tạo
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Trạng thái
                                                                    </th>


                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Khách hàng
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng SP
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Tổng tiền
                                                                    </th>
                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Thời gian hủy
                                                                    </th>

                                                                    <th style="position: sticky; top: 0;background-color: #ff9f43; color: white;">
                                                                        Hành động
                                                                    </th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <th:block th:each="bill, i: ${listHoaDonOnline}">
                                                                    <tr th:if="${bill.trangThai == 5}">


                                                                        <td th:text="${i.index}"></td>
                                                                        <td th:text="${bill.maHD}"></td>

                                                                        <td th:if="${bill.hinhThucThanhToan == 1}">
                                                                            VNPAY
                                                                        </td>
                                                                        <td th:if="${bill.hinhThucThanhToan == 0}">
                                                                            TT khi nhận hàng
                                                                        </td>
                                                                        <td th:if="${bill.nhanVien != null && bill.nhanVien.hoTenNV != null}"
                                                                            th:text="${bill.nhanVien.hoTenNV}">
                                                                        </td>
                                                                        `
                                                                        <td th:if="${bill.nhanVien == null || bill.nhanVien.hoTenNV == null}">
                                                                            Chưa có
                                                                        </td>


                                                                        <td th:text="${#dates.format(bill.tgTao, 'HH:mm yyyy-MM-dd')}"></td>

                                                                        <td th:if="${bill.trangThai == 5}"> Đã hủy
                                                                        </td>


                                                                        <td th:text="${bill.khachHang.hoTenKH}"></td>
                                                                        <td th:text="${bill.tongSP}"></td>
                                                                        <td th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 0, 'POINT')}"></td>
                                                                        <td th:if="${bill.tgHuy != null}"
                                                                            th:text="${#dates.format(bill.tgHuy, 'HH:mm yyyy-MM-dd')}"></td>
                                                                        <td th:if="${bill.tgHuy == null}">Chưa
                                                                            có
                                                                        </td>
                                                                        <td>
                                                                            <i class="si si-speedometer"
                                                                               th:data-bs-toggle="modal"
                                                                               th:data-bs-target="'#modalXemLichSuThanhToan' + ${bill.idHD}"
                                                                               style="cursor: pointer; margin: 0 20px 0 0; color: #ff9f43;"></i>
                                                                        </td>
                                                                    </tr>
                                                                </th:block>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>


                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>
</div>

<section>

    <!-- Modal All Purchase Begin -->

    <!-- Modal All Purchase End -->

    <!--    Modal xem lịch sử thanh toán-->
    <th:block th:each="bill: ${listHoaDonOnline}">
        <div th:unless="${bill.trangThai == 6}" class="modal fade" th:id="'modalXemLichSuThanhToan' + ${bill.idHD}"
             tabindex="-1" aria-labelledby="create" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered" role="document" style="width: 1200px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Lịch sử thanh toán</h5>
                        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-lg-5 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Mã Hóa Đơn :</label>
                                    <p style="font-size: 13pt; font-weight: 700;" th:text="${bill.maHD}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Tên Khách Hàng
                                        :</label>
                                    <p th:text="${bill.khachHang.hoTenKH}"></p>
                                </div>
                            </div>
                            <div class="col-lg-4 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Tổng tiền</label>
                                    <p th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 0, 'POINT')}"></p>
                                </div>
                            </div>
                            <div class="col-lg-5 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Thời gian tạo hóa
                                        đơn :</label>
                                    <p th:text="${#dates.format(bill.tgTao, 'HH:mm yyyy-MM-dd')}"></p>

                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Loại hóa đơn</label>
                                    <p>Hóa đơn mua hàng</p>
                                </div>
                            </div>
                            <div class="col-lg-4 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Trạng thái hóa
                                        đơn</label>
                                    <p th:if="${bill.trangThai == 0 }">Chờ thanh toán</p>
                                    <p th:if="${bill.trangThai == 1 }">Chờ xác nhận </p>
                                    <p th:if="${bill.trangThai == 2 }">Chờ lấy hàng</p>
                                    <p th:if="${bill.trangThai == 3 }">Chờ giao hàng</p>
                                    <p th:if="${bill.trangThai == 4 }">Giao thành công</p>
                                    <p th:if="${bill.trangThai == 5 }">Đã Hủy</p>
                                </div>
                            </div>
                            <div class="col-lg-12 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Lịch sử thanh toán
                                        của hóa đơn</label>
                                </div>
                            </div>

                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Mã LSTT</label>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Số tiền</label>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Thời gian</label>
                                </div>
                            </div>
                            <div class="col-lg-5 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Nội dung </label>
                                </div>
                            </div>
                            <!-- So lan thay doi -->
                            <th:block th:each="x: ${bill.lichSuThanhToans}">
                                <div class="col-lg-3 col-sm-12 col-12">
                                    <div class="form-group">
                                        <p th:text="${x.maLSTT}"></p>
                                    </div>
                                </div>
                                <div class="col-lg-2 col-sm-12 col-12">
                                    <div class="form-group">
                                        <p th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 2, 'POINT').replaceAll('([,.])0+$', '$1').replaceAll('\\.$', '')}"></p>

                                    </div>
                                </div>
                                <div class="col-lg-2 col-sm-12 col-12">
                                    <div class="form-group">
                                        <p th:text="${#dates.format(x.tgThanhToan, 'HH:mm yyyy-MM-dd')}"></p>
                                    </div>
                                </div>
                                <div class="col-lg-5 col-sm-12 col-12">
                                    <div class="form-group">
                                        <p th:text="${x.noiDungThanhToan}"></p>
                                    </div>
                                </div>
                            </th:block>
                            <!-- So lan thay doi -->

                            <th:block th:each="x: ${bill.lichSuThanhToans}">
                                <div th:if="${x.trangThai == 3 }" class="col-lg-12 col-sm-12 col-12">
                                    <button th:data-bs-toggle="modal"
                                            th:data-bs-target="'#xacNhanHoanTienHDHuy' + ${bill.idHD}"
                                            class="btn btn-submit">Hoàn tiền tới khách hàng
                                    </button>
                                </div>
                            </th:block>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </th:block>
    <!--    Modal xem lịch sử thanh toán-->


    <!--    Modal delete thanh toán-->
    <th:block th:each="bill: ${listHoaDonOnline}">
        <div class="modal fade" th:id="'modalHuyHoaDon' + ${bill.idHD}" tabindex="-1" aria-labelledby="create"
             aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered" role="document" style="width: 1200px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Hủy hóa đơn </h5>
                        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form th:action="@{'/manage/bill/online/delete/' + ${bill.idHD}}" method="get"
                              id="huyHoaDonForm">
                            <div class="form-group">
                                <label for="lyDoHuy">Lí do hủy hóa đơn: </label>
                                <input type="text" class="form-control" id="lyDoHuy" th:id="lyDoHuy" name="lyDoHuy"
                                       th:name="lyDoHuy"/>
                                <div class="invalid-feedback">Vui lòng nhập lí do hủy hóa đơn.</div>
                            </div>
                            <button type="submit" class="btn btn-danger" style="margin-top: 21px">Hủy hóa đơn</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </th:block>


    <!--    Modal delete thanh toán-->

    <!--    Modal edit thanh toán-->
    <th:block th:each="bill: ${listHoaDonOnline}">
        <div class="modal fade" th:id="'modalEditHoaDon' + ${bill.idHD}" tabindex="-1" aria-labelledby="create"
             aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered" role="document" style="width: 1200px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Chỉnh sửa hóa đơn </h5>
                        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="tab-content">
                        <div class="tab-pane show active">
                            <div class="row">
                                <div class="col-lg-7 col-sm-12 tabs_wrapper">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="table-top">
                                                <form method="get" action="/manage/bill/search">
                                                    <div class="search-set">
                                                        <div class="search-path">
                                                            <button class="btn btn-searchset" type="submit">
                                                                <img src="/images/img/icons/search-white.svg" alt="img">
                                                            </button>
                                                        </div>
                                                        <div>
                                                            <div>
                                                                <input type="search"
                                                                       class="form-control form-control-sm"
                                                                       name="keyword" placeholder="Tìm kiếm..."
                                                                       aria-controls="DataTables_Table_0">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="tabs_container">
                                        <div class="row">
                                            <div th:if="${nullHoaDon}"
                                                 class="alert alert-success text-center">
                                                <h3 th:text="${nullHoaDon}"></h3>
                                            </div>
                                        </div>

                                        <table class="table table-bordered product-table">
                                            <thead>
                                            <tr>
                                                <th>Hình Ảnh</th>
                                                <th>Số Lượng</th>
                                                <th>Tên Giày</th>
                                                <th>Giá Bán</th>
                                                <th>Màu Sắc</th>
                                                <th>Hành Động</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <th:block th:each="product : ${listSanPham}">
                                                <tr>
                                                    <td>
                                                        <img style="height: 90px;width: 90px"
                                                             th:src="@{'/images/imgsProducts/'+ ${product.hinhAnh}}"
                                                             alt="img">
                                                    </td>
                                                    <td>
                                                        <h6>[[${product.soLuong}]]</h6>
                                                    </td>
                                                    <td>
                                                        <h3 style="font-size: 12pt">
                                                            [[${product.tenGiay}]]</h3>
                                                    </td>
                                                    <td>
                                                        <h3 style="font-size: 12pt"
                                                            th:text=" ${#numbers.formatDecimal(product.giaBan, 0, 'COMMA', 2, 'POINT').replaceAll('([,.])0+$', '$1').replaceAll('\\.$', '')} + ' đ'"></h3>
                                                    </td>
                                                    <td>
                                                        <h4 style="font-size: 12pt"
                                                            th:text="${product.mauSac}"></h4>
                                                    </td>
                                                    <td>
                                                        <a style="font-size: 11pt"
                                                           th:href="@{'/manage/bill/chon-size2/' + ${product.idGiay}+'/'+${product.mauSac} }"
                                                           class="btn btn-outline-warning">Chọn</a>
                                                    </td>
                                                </tr>
                                            </th:block>
                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                                <div class="col-lg-5 col-sm-12 ">
                                    <div class="order-list">
                                        <div class="orderid">
                                            <nav class="navbar navbar-expand-lg">
                                                <a class="btn" th:href="@{/ban-hang/add-cart}">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="25"
                                                         height="25"
                                                         fill="currentColor"
                                                         class="bi bi-person-add" viewBox="0 0 16 16">
                                                        <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Zm-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"/>
                                                        <path d="M8.256 14a4.474 4.474 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10c.26 0 .507.009.74.025.226-.341.496-.65.804-.918C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4s1 1 1 1h5.256Z"/>
                                                    </svg>
                                                </a>


                                            </nav>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>


                    <div class="modal-body">

                        <table class="table">
                            <thead>
                            <tr>
                                <th>Sản phẩm</th>
                                <th>Phân loại</th>
                                <th>Số lượng</th>
                                <th>Thành tiền</th>
                                <th>Hoạt động</th>
                            </tr>
                            </thead>
                            <tbody>
                            <th:block th:each="x: ${bill.hoaDonChiTiets}">
                                <tr th:if="${x.chiTietGiay.trangThai == 1}" id="productId"
                                    th:value="${x.chiTietGiay.idCTG}">
                                    <td style="width: 400px;" class="product__cart__item">
                                        <div class="product__cart__item__pic">
                                            <a th:href="@{'/buyer/shop-details/' + ${x.chiTietGiay.giay.idGiay} + '/' + ${x.chiTietGiay.mauSac.idMau}}">
                                                <img style="width:90px; height:90px;"
                                                     th:src="@{'/images/imgsProducts/' + ${x.chiTietGiay.hinhAnh.url1}}">
                                            </a>
                                        </div>
                                        <div class="product__cart__item__text">
                                            <a th:href="@{'/buyer/shop-details/' + ${x.chiTietGiay.giay.idGiay} + '/' + ${x.chiTietGiay.mauSac.idMau}}">
                                                <h6 style="margin-top: -22px;"
                                                    th:text="${x.chiTietGiay.giay.tenGiay}"></h6>
                                            </a>
                                            <h5 class="cart__price"
                                                th:text="'₫' + ${#numbers.formatDecimal(x.chiTietGiay.giaBan, 0, 'COMMA', 2, 'POINT').replaceAll('([,.])0+$', '$1').replaceAll('\\.$', '')}"></h5>
                                        </div>
                                    </td>
                                    <td style="width: 175px;" class="quantity__item">
                                        <div style="margin-top: -20px; display: block;">
                                            <span id="showButton" style="font-weight: normal; font-size: medium;">Phân loại :</span>
                                            <a th:href="@{'/buyer/cart/option/' + ${x.chiTietGiay.giay.idGiay} + '/' + ${x.chiTietGiay.mauSac.idMau} + '/' + ${x.chiTietGiay.idCTG}}">
                                                <img style="height: 10px; width: 10px;"
                                                     src="/images/img/icon/dropdown.png" alt="">
                                            </a>
                                        </div>
                                        <div style="padding-right: 20px;">
                                            <span style="font-size: 10pt; font-weight: 500; color: rgba(0,0,0,.54);"
                                                  th:text="'Colors : ' + ${x.chiTietGiay.mauSac.tenMau}"></span>
                                            <span style="font-size: 10pt; font-weight: 500; color: rgba(0,0,0,.54);"
                                                  th:text="'Size : ' + ${x.chiTietGiay.size.soSize}"></span>
                                        </div>
                                    </td>
                                    <td style="width: 175px;" class="quantity__item">
                                        <div class="quantity">
                                            <input class="quantityInput" oninput="validateQuantity(this)"
                                                   th:value="${x.soLuong}"
                                                   style="width: 50px; text-align: center; border: 1px solid black;"
                                                   type="number" name="quantities">
                                        </div>
                                    </td>
                                    <td style="width: 140px;" class="cart__price totalAmount"
                                        th:text="'₫' + ${#numbers.formatDecimal(x.chiTietGiay.giaBan * x.soLuong, 0, 'COMMA', 2, 'POINT').replaceAll('([,.])0+$', '$1').replaceAll('\\.$', '')}"></td>
                                    <!--                                    <td>-->
                                    <!--                                        <form th:action="@{/manage/bill/deleteChiTietGiay/{idCTG}/{idHD}(idCTG=${x.chiTietGiay.idCTG}, idHD=${bill.idHD})}" method="post">-->
                                    <!--                                            <button type="submit" class="btn btn-danger btn-sm" >Xóa</button>-->
                                    <!--                                        </form>-->
                                    <!--                                    </td>-->
                                    <td>
                                        <form id="deleteForm"
                                              th:action="@{/manage/bill/deleteChiTietGiay/{idCTG}/{idHD}(idCTG=${x.chiTietGiay.idCTG}, idHD=${bill.idHD})}"
                                              method="post">
                                            <button type="button" class="btn btn-danger btn-sm"
                                                    onclick="confirmDelete()">Xóa
                                            </button>
                                        </form>
                                    </td>

                                </tr>
                            </th:block>

                        </table>
                    </div>
                </div>
            </div>
        </div>
    </th:block>
    <!--    Modal edit chọn size-->

    <th:block th:each="bill: ${listHoaDonOnline}">
        <div th:unless="${bill.trangThai == 6}" class="modal fade" th:id="'modalDetailHD' + ${bill.idHD}" tabindex="-1"
             aria-labelledby="create" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered" role="document" style="width: 900px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Chi tiết hóa đơn</h5>
                        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Mã Hóa Đơn :</label>
                                    <p th:text="${bill.maHD}"></p>
                                </div>
                            </div>

                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Tên Khách Hàng
                                        :</label>
                                    <p th:text="${bill.khachHang.hoTenKH}"></p>
                                </div>
                            </div>

                            <div class="col-lg-2 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Tổng tiền</label>
                                    <p th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 0, 'POINT')}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Giá tiền
                                        giảm</label>
                                    <p th:if="${bill.khuyenMai != null and bill.khuyenMai.giaTienGiam > 0}"
                                       th:text="'₫' + ${#numbers.formatDecimal(bill.khuyenMai.giaTienGiam, 0, 'COMMA', 0, 'POINT')}"></p>
                                    <p th:if="${bill.khuyenMai == null or bill.khuyenMai.giaTienGiam <= 0}">₫0</p>
                                </div>
                            </div>

                            <div class="col-lg-4 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Thời gian tạo hóa
                                        đơn</label>
                                    <p th:text="${#dates.format(bill.tgTao, 'HH:mm yyyy-MM-dd')}"></p>
                                </div>
                            </div>

                            <div class="col-lg-4 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Loại hóa đơn</label>
                                    <p> Hóa đơn mua hàng</p>
                                </div>
                            </div>

                            <div class="col-lg-4 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Trạng thái hóa
                                        đơn</label>
                                    <p th:if="${bill.trangThai == 0 }">Chờ thanh toán</p>
                                    <p th:if="${bill.trangThai == 1 }">Chờ xác nhận </p>
                                    <p th:if="${bill.trangThai == 2 }">Chờ lấy hàng</p>
                                    <p th:if="${bill.trangThai == 3 }">Chờ giao hàng</p>
                                    <p th:if="${bill.trangThai == 4 }">Giao thành công</p>
                                    <p th:if="${bill.trangThai == 5 }">Đã Hủy</p>
                                </div>

                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600; color: red">Lí do
                                        hủy:</label>
                                    <p th:text="${#strings.isEmpty(bill.getLyDoHuy()) ? 'Không có' : bill.getLyDoHuy()}"></p>
                                </div>
                            </div>


                            <div class="col-lg-12 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Chi tiết hóa
                                        đơn</label>
                                </div>
                            </div>

                            <div class="col-lg-2 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Ảnh</label>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Tên</label>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Phân loại</label>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Số lượng</label>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label style="border: none; font-size: 12pt; font-weight: 600;">Thành tiền</label>
                                </div>
                            </div>

                            <th:block th:each="x: ${bill.hoaDonChiTiets}">
                                <div class="col-lg-2 col-sm-12 col-12">
                                    <div class="form-group">
                                        <img th:src="@{'/images/imgsProducts/'+ ${x.chiTietGiay.hinhAnh.url1}}">
                                    </div>
                                </div>
                                <div class="col-lg-2 col-sm-12 col-12">
                                    <div class="form-group">
                                        <p th:text="${x.chiTietGiay.giay.tenGiay}"></p>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-12 col-12">
                                    <div class="form-group">
                                        <p th:text="'Size : ' + ${x.chiTietGiay.size.soSize}"></p>
                                        <p th:text="'Màu sắc : ' + ${x.chiTietGiay.mauSac.tenMau}"></p>
                                    </div>
                                </div>
                                <div class="col-lg-2 col-sm-12 col-12">
                                    <div class="form-group">
                                        <p th:text="${x.soLuong}"></p>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-sm-12 col-12">
                                    <div class="form-group">
                                        <p th:text="'₫'+${#numbers.formatDecimal(x.tongTien, 0, 'COMMA', 2, 'POINT').replaceAll('([,.])0+$', '$1').replaceAll('\\.$', '')}"></p>
                                    </div>
                                </div>
                            </th:block>
                        </div>
                        <div class="col-lg-12">
                            <a class="btn btn-cancel" data-bs-dismiss="modal" style="margin-right: 30px;">OK</a>
                            <a th:if="${bill.trangThai == 0 or bill.trangThai == 1}"
                               th:href="@{'/manage/bill/online/delete/' + ${bill.idHD}}"
                               class="btn btn-cancel">Hủy hóa đơn</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </th:block>


    <div th:if="${showModal1}" class="modal fade" id="chonSize" tabindex="-1" aria-labelledby="exampleModalLabel"
         aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">

        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Sản phẩm</h5>

                    <a type="button" th:href="@{'/manage/changehd/online/'+ ${idHD} }">
                        <span aria-hidden="true">×</span>
                    </a>
                </div>
                <div class="modal-body">
                    <div class="row m-3">
                        <div class="col-6">
                            <img th:src="@{'/images/imgsProducts/'+ ${giay.chiTietGiayList.get(0).hinhAnh.url1}}" alt=""
                                 height="400" width="300">
                        </div>
                        <div class="col-6">
                            <div class="container">
                                <div class="row">
                                    <div class="">
                                        <div class="text-left fs-2 fw-bolder">
                                            <label th:text="${giay.tenGiay}"></label>
                                        </div>
                                        <div class="text-left fs-3 fw-normal">
                                            <label th:text="${'Hãng : '+ giay.hang.tenHang}"></label>
                                            <div id="sizeQuantity" th:if="${not #lists.isEmpty(listChiTietGiay)}">
                                                Còn hàng <span th:text="${listChiTietGiay.get(0).soLuong}"></span> đôi
                                            </div>
                                        </div>
                                        <div class="text-left fs-4">

                                            <form th:action="@{'/manage/bill/add-to-hd/' + ${idHoaDon}}" method="get">
                                                <input type="hidden" th:value="${idHoaDon}" name="idHoaDon"/>
                                                <div class="">
                                                    <input type="number" name="soLuong" value="1" min="1"
                                                           class="form-control"/>
                                                </div>
                                                <div class="row">
                                                    <div th:each="chiTiet : ${listChiTietGiay}" class="col-md-3">
                                                        <label>
                                                            <input type="radio" name="idChiTietGiay"
                                                                   th:data-size="${chiTiet.size.soSize}"
                                                                   th:value="${chiTiet.idCTG}"
                                                                   th:data-quantity="${chiTiet.soLuong}"
                                                                   th:onclick="'displaySizeQuantity(this)'"
                                                                   th:checked="${chiTiet == listChiTietGiay.get(0)}"/>
                                                            <span th:text="${chiTiet.size.soSize}"></span>
                                                        </label>
                                                    </div>
                                                </div>
                                                <button type="submit" class="btn btn-secondary btn-center mt-3">Thêm giỏ
                                                    hàng
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal detail Hóa Đơn begin-->
    <div th:if="${showModal1}" class="modal fade" id="chonSize" tabindex="-1" aria-labelledby="exampleModalLabel"
         aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">

        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Sản phẩm</h5>

                    <a type="button" th:href="@{'/manage/changehd/online/'+ ${idHD} }">
                        <span aria-hidden="true">×</span>
                    </a>
                </div>
                <div class="modal-body">
                    <div class="row m-3">
                        <div class="col-6">
                            <img th:src="@{'/images/imgsProducts/'+ ${giay.chiTietGiayList.get(0).hinhAnh.url1}}" alt=""
                                 height="400" width="300">
                        </div>
                        <div class="col-6">
                            <div class="container">
                                <div class="row">
                                    <div class="">
                                        <div class="text-left fs-2 fw-bolder">
                                            <label th:text="${giay.tenGiay}"></label>
                                        </div>
                                        <div class="text-left fs-3 fw-normal">
                                            <label th:text="${'Hãng : '+ giay.hang.tenHang}"></label>
                                            <div id="sizeQuantity" th:if="${not #lists.isEmpty(listChiTietGiay)}">
                                                Còn hàng <span th:text="${listChiTietGiay.get(0).soLuong}"></span> đôi
                                            </div>
                                        </div>
                                        <div class="text-left fs-4">

                                            <form th:action="@{'/manage/changehd/add-to-hd/' + ${idHoaDon}}"
                                                  method="get">
                                                <input type="hidden" th:value="${idHoaDon}" name="idHoaDon"/>
                                                <div class="">
                                                    <input type="number" name="soLuong" value="1" min="1"
                                                           class="form-control"/>
                                                </div>
                                                <div class="row">
                                                    <div th:each="chiTiet : ${listChiTietGiay}" class="col-md-3">
                                                        <label>
                                                            <input type="radio" name="idChiTietGiay"
                                                                   th:data-size="${chiTiet.size.soSize}"
                                                                   th:value="${chiTiet.idCTG}"
                                                                   th:data-quantity="${chiTiet.soLuong}"
                                                                   th:onclick="'displaySizeQuantity(this)'"
                                                                   th:checked="${chiTiet == listChiTietGiay.get(0)}"/>
                                                            <span th:text="${chiTiet.size.soSize}"></span>
                                                        </label>
                                                    </div>
                                                </div>
                                                <button type="submit" class="btn btn-secondary btn-center mt-3">Thêm giỏ
                                                    hàng
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal detail Hóa Đơn end-->


    <!-- Modal All giao hàng Begin -->
    <th:block th:each="bill: ${listHoaDonOnlineGiaoHang}">
        <div class="modal fade" th:id="'viewBillGH' + ${bill.idHD}" tabindex="-1" aria-labelledby="create"
             aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered" role="document" style="width: 900px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Chi tiết hóa đơn đang giao</h5>

                        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-lg-4 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Mã đơn hàng :</label>
                                    <p style="font-size: 13pt; font-weight: 700;" th:text="${bill.maHD}"></p>
                                </div>
                            </div>

                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Số tiền :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:text="'₫'+${#numbers.formatDecimal(bill.tongTien, 0, 'COMMA', 2, 'POINT').replaceAll('([,.])0+$', '$1').replaceAll('\\.$', '')}"></p>
                                </div>
                            </div>

                            <div class="col-lg-2 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Số lượng SP :</label>
                                    <p style="font-size: 12pt; font-weight: 700;" th:text="${bill.tongSP}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Thời gian tạo :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:text="${#dates.format(bill.tgTao, 'HH:mm yyyy-MM-dd')}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Nhân viên giao :</label>
                                    <p th:if="${bill.nhanVien != null}" th:text="${bill.nhanVien.hoTenNV}"
                                       style="font-size: 12pt; font-weight: 700;"></p>
                                    <p th:if="${bill.nhanVien == null}" style="font-size: 12pt; font-weight: 700;">Chưa
                                        có</p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Số điện thoại người nhận:</label>
                                    <p style="font-size: 12pt; font-weight: 700;"
                                       th:text="${bill.giaoHang.sdtNguoiNhan}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Tên khách hàng :</label>
                                    <p style="font-size: 12pt; font-weight: 700;"
                                       th:text="${bill.giaoHang.tenNguoiNhan}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Thời gian giao hàng :</label>
                                    <p style="font-size: 11pt; font-weight: 600;" th:if="${bill.giaoHang.tgShip !=null}"
                                       th:text="${#dates.format(bill.giaoHang.tgShip, 'HH:mm yyyy-MM-dd')}"></p>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:unless="${bill.giaoHang.tgShip !=null}">Chưa
                                        giao</p>
                                </div>
                            </div>
                            <div class="col-lg-12 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Địa chỉ nhận hàng :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:text="${bill.giaoHang.diaChiNguoiNhan}"></p>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <a class="btn btn-cancel" data-bs-dismiss="modal">OK</a>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </th:block>
    <!-- Modal All Purchase End a-->

    <!-- Modal All giao hàng Begin -->
    <div th:if="${showEditBillDelivery}" th:object="${billDelivery}" class="modal fade" id="editBillDelivery"
         tabindex="-1" aria-labelledby="create" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document" style="width: 900px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Chi tiết hóa đơn đang giao</h5>

                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form th:action="@{'/manage/bill/online/delivery/confirm/' + ${billDelivery.idHD}}" method="post">
                        <div class="row">
                            <div class="col-lg-4 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Mã đơn hàng :</label>
                                    <p style="font-size: 13pt; font-weight: 700;" th:text="${billDelivery.maHD}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Số tiền :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:text="'₫'+${#numbers.formatDecimal(billDelivery.tongTien, 0, 'COMMA', 2, 'POINT').replaceAll('([,.])0+$', '$1').replaceAll('\\.$', '')}"></p>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Số lượng SP :</label>
                                    <p style="font-size: 12pt; font-weight: 700;" th:text="${billDelivery.tongSP}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Thời gian tạo :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:text="${#dates.format(billDelivery.tgTao, 'HH:mm yyyy-MM-dd')}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Nhân viên giao :</label>
                                    <select name="idNhanVien" class="form-control nested">
                                        <th:block th:each="nv: ${listNhanVienGiao}">
                                            <option th:value="${nv.idNV}"
                                                    th:text="${nv.hoTenNV + '--' + nv.maNV}"></option>
                                        </th:block>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Số điện thoại người nhận:</label>
                                    <p style="font-size: 12pt; font-weight: 700;"
                                       th:text="${billDelivery.giaoHang.sdtNguoiNhan}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Tên khách hàng :</label>
                                    <p style="font-size: 12pt; font-weight: 700;"
                                       th:text="${billDelivery.giaoHang.tenNguoiNhan}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Thời gian giao hàng :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:if="${billDelivery.giaoHang.tgShip !=null}"
                                       th:text="${#dates.format(billDelivery.giaoHang.tgShip, 'HH:mm yyyy-MM-dd')}"></p>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:unless="${billDelivery.giaoHang.tgShip !=null}">Chưa giao</p>
                                </div>
                            </div>
                            <div class="col-lg-12 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Địa chỉ nhận hàng :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:text="${billDelivery.giaoHang.diaChiNguoiNhan}"></p>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <button type="submit" class="btn btn-submit me-2">Xác nhận</button>
                                <a class="btn btn-cancel" data-bs-dismiss="modal">Đóng</a>
                            </div>

                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal All Purchase End a -->

    <!-- Modal All giao hàng Begin -->
    <div th:if="${showEditBillRefundDelivery}" th:object="${billDelivery}" class="modal fade"
         id="editBillRefundDelivery" tabindex="-1" aria-labelledby="create" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document" style="width: 900px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Chi tiết hóa đơn hoàn hàng</h5>

                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form th:action="@{'/manage/bill/online/refund/delivery/confirm/' + ${billDelivery.idHD}}"
                          method="post">
                        <div class="row">
                            <div class="col-lg-4 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Mã đơn hàng :</label>
                                    <p style="font-size: 13pt; font-weight: 700;" th:text="${billDelivery.maHD}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Số tiền :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:text="'₫'+${#numbers.formatDecimal(billDelivery.tongTien, 0, 'COMMA', 2, 'POINT').replaceAll('([,.])0+$', '$1').replaceAll('\\.$', '')}"></p>
                                </div>
                            </div>
                            <div class="col-lg-2 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Số lượng SP :</label>
                                    <p style="font-size: 12pt; font-weight: 700;" th:text="${billDelivery.tongSP}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Thời gian tạo :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:text="${#dates.format(billDelivery.tgTao, 'HH:mm yyyy-MM-dd')}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Nhân viên giao :</label>
                                    <select name="idNhanVien" class="form-control nested">
                                        <th:block th:each="nv: ${listNhanVienGiao}">
                                            <option th:value="${nv.idNV}"
                                                    th:text="${nv.hoTenNV + '--' + nv.maNV}"></option>
                                        </th:block>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Số điện thoại người nhận:</label>
                                    <p style="font-size: 12pt; font-weight: 700;"
                                       th:text="${billDelivery.giaoHang.sdtNguoiNhan}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Tên khách hàng :</label>
                                    <p style="font-size: 12pt; font-weight: 700;"
                                       th:text="${billDelivery.giaoHang.tenNguoiNhan}"></p>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Thời gian giao hàng :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:if="${billDelivery.giaoHang.tgShip !=null}"
                                       th:text="${#dates.format(billDelivery.giaoHang.tgShip, 'HH:mm yyyy-MM-dd')}"></p>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:unless="${billDelivery.giaoHang.tgShip !=null}">Chưa giao</p>
                                </div>
                            </div>
                            <div class="col-lg-12 col-sm-12 col-12">
                                <div class="form-group">
                                    <label>Địa chỉ nhận hàng :</label>
                                    <p style="font-size: 11pt; font-weight: 600;"
                                       th:text="${billDelivery.giaoHang.diaChiNguoiNhan}"></p>
                                </div>
                            </div>
                            <div class="col-lg-12">
                                <button type="submit" class="btn btn-submit me-2">Xác nhận</button>
                                <a class="btn btn-cancel" data-bs-dismiss="modal">Đóng</a>
                            </div>

                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal All Purchase End -->
</section>

<script src="/js/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/js/feather.min.js"></script>
<script src="/js/jquery.slimscroll.min.js"></script>
<script src="/js/jquery.dataTables.min.js"></script>
<script src="/js/dataTables.bootstrap4.min.js"></script>
<script src="/plugins/select2/js/select2.min.js"></script>
<script src="/plugins/select2/js/custom-select.js"></script>
<script src="/js/bootstrap.bundle.min.js"></script>
<script src="/plugins/scrollbar/scrollbar.min.js"></script>
<script src="/plugins/scrollbar/custom-scroll.js"></script>
<script src="/plugins/sweetalert/sweetalert2.all.min.js"></script>
<script src="/plugins/sweetalert/sweetalerts.min.js"></script>
<script src="/js/script.js"></script>

<script th:inline="javascript">
    /*<![CDATA[*/
    document.addEventListener('DOMContentLoaded', function () {
        var huyHoaDonForm = document.getElementById('huyHoaDonForm');
        huyHoaDonForm.addEventListener('submit', function (event) {
            var lyDoHuyInput = document.getElementById('lyDoHuy');
            var invalidFeedback = document.querySelector('#huyHoaDonForm .invalid-feedback');
            if (lyDoHuyInput.value.trim() === '') {
                event.preventDefault(); // Ngăn form submit nếu ly do huy không được nhập
                invalidFeedback.style.display = 'block';
            } else {
                invalidFeedback.style.display = 'none';
            }
        });
    });
    /*]]>*/
</script>

<script>
    // Lấy tất cả các container của form
    const formContainers = document.querySelectorAll('.form-container');
    // Duyệt qua từng form và gán sự kiện cho input
    formContainers.forEach(function (container) {
        const maHDElement = container.querySelector('.maHD');
        const inputMaHDElement = container.querySelector('.inputMaHD');
        const btnSubmitElement = container.querySelector('.btn-submit');

        inputMaHDElement.addEventListener('input', function () {
            if (inputMaHDElement.value === maHDElement.innerText) {
                btnSubmitElement.removeAttribute('disabled');
            } else {
                btnSubmitElement.setAttribute('disabled', 'true');
                alert('Mã hóa đơn không đúng!');

            }
        });
    });
</script>

<!--Confirm thong bao pay end-->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".btn-cancel").forEach(function (btn) {
            btn.addEventListener("click", function (event) {
                if (btn.getAttribute("data-bs-dismiss") !== "modal") {
                    setTimeout(function () {
                        window.location.href = btn.getAttribute("href");
                    }, 500);  // Thời gian chờ để modal đóng hoàn toàn
                    event.preventDefault();
                }
            });
        });
    });
</script>

<script>
    $(document).ready(function () {
        $('#editBillDelivery').modal('show');
    });
    $(document).ready(function () {
        $('#messBillDeliveryThanhCong').modal('show');
    });
    $(document).ready(function () {
        $('#editBillRefundDelivery').modal('show');
    });
    $(document).ready(function () {
        $('#hoanTienThanhCong').modal('show');
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const alert = document.querySelector('.custom-alert');
        if (alert) {
            setTimeout(() => {
                alert.classList.add('hide');
            }, 5000); // 5 giây
        }
    });
</script>

<script>
    function confirmDelete() {
        Swal.fire({
            title: 'Bạn có chắc chắn muốn xóa sản phẩm này không?',
            text: "Bạn sẽ không thể khôi phục lại điều này!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Có, xóa nó!',
            cancelButtonText: 'Hủy bỏ'
        }).then((result) => {
            if (result.isConfirmed) {
                deleteProduct();
            }
        });
    }

    function deleteProduct() {
        var form = document.getElementById('deleteForm');
        var url = form.action;

        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
        })
            .then(response => {
                if (response.ok) {
                    return response.text();
                } else {
                    throw new Error('Network response was not ok.');
                }
            })
            .then(data => {
                // Xử lý khi xóa thành công, ví dụ xóa dòng trong bảng
                Swal.fire(
                    'Đã xóa!',
                    data,
                    'success'
                ).then(() => {
                    form.closest('tr').remove();
                });
            })
            .catch(error => {
                console.error('Error:', error);
                Swal.fire(
                    'Lỗi!',
                    'Có lỗi xảy ra trong quá trình xoá sản phẩm!',
                    'error'
                );
            });
    }
</script>

<script>
    $(document).ready(function () {
        $('#chonSize').modal('show');
    });
</script>
<script>
    $(document).ready(function () {
        $("#locTrangThai").change(function () {
            var maTrangThai = $(this).val();


            // Ẩn tất cả các dòng trong bảng
            $("#data-table tbody tr").hide();

            // Hiển thị các dòng có giá trị kích thước tương ứng
            $("#data-table tbody tr").each(function () {
                var maTT = $(this).find("td:eq(3)").text(); // Vị trí cột chứa giá trị kích thước
                if (maTT === maTrangThai || maTrangThai === "Trạng thái") {
                    $(this).show();
                }
            });
            console.log(maTrangThai);
        });
    });
</script>
</body>
</html>