<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <meta name="description" content="POS - Bootstrap Admin Template">
    <meta name="keywords"
          content="admin, estimates, bootstrap, business, corporate, creative, invoice, html5, responsive, Projects">
    <meta name="author" content="Dreamguys - Bootstrap Admin Template">
    <meta name="robots" content="noindex, nofollow">
    <title>Teezy Shop - Admin</title>

    <link rel="shortcut icon" type="image/x-icon" href="/images/img/icon.png">
    <link rel="stylesheet" href="/plugins/icons/flags/flags.css">
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <link rel="stylesheet" href="/css/animate.css">

    <link rel="stylesheet" href="/plugins/select2/css/select2.min.css">

    <link rel="stylesheet" href="/css/dataTables.bootstrap4.min.css">

    <link rel="stylesheet" href="/plugins/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" href="/plugins/fontawesome/css/all.min.css">

    <link rel="stylesheet" href="/plugins/toastr/toatr.css"/>

    <link rel="stylesheet" href="/css/style.css">
    <!-- Thêm link thư viện Alertify -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/AlertifyJS/1.13.1/css/alertify.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/AlertifyJS/1.13.1/css/themes/default.min.css"/>
    <style>
        .alertify .ajs-message {
            background-color: black;
            color: #ffffff;
        }

        /* Thay đổi màu nền của tiêu đề */
        .alertify .ajs-header {
            background-color: coral;
            color: #ffffff;
        }

        /* Thay đổi màu nền của các nút */
        .alertify .ajs-buttons .ajs-ok {
            background-color: #2ecc71;
            color: #ffffff;
        }
    </style>
    <style>
        .color-box {
            width: 40px; /* Độ rộng của hộp màu */
            height: 40px; /* Chiều cao của hộp màu */
            display: inline-block; /* Hiển thị như một hộp chữ nằm cạnh nhau */
            border: 1px solid #000; /* Viền xung quanh hộp màu */
            margin: 0 5px; /* Khoảng cách giữa các hộp màu */
            border-radius: 50%;
        }
    </style>
    <style>
        /* Định dạng lớp CSS để làm cho input to hơn */
        .large-input {
            /*width: 230px; !* Điều chỉnh kích thước theo nhu cầu của bạn *!*/
            /*height: 40px; !* Điều chỉnh kích thước theo nhu cầu của bạn *!*/
            border: none;
        }
    </style>
</head>
<body class="mini-sidebar">
<div th:replace="~{manage/activities :: main}"></div>

<form th:object="${updateKhuyenMai}" onsubmit="return validateKhuyenMaiForm()" name="khuyenMaiForm" method="post">
    <div class="page-wrapper">
        <div class="content">
            <div class="page-header">
                <div class="page-title">
                    <h4>Update Khuyến mãi</h4>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <div class="row" style="display: none">
                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>ID khuyễn mãi</label>
                                <input type="text" th:field="*{idKM}" class="form-control">
                            </div>
                        </div>


                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>Mã KM</label>
                                <input type="text" th:field="*{maKM}" class="form-control">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>Tên khuyễn mãi</label>
                                <input type="text" th:field="*{tenKM}" class="form-control">
                            </div>
                        </div>


                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>Số lượng</label>
                                <input type="text" th:field="*{soLuong}" class="form-control">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>Giảm</label>
                                <input type="number" th:field="*{giaTienGiam}" class="form-control">
                            </div>
                        </div>


                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>Điều kiện</label>
                                <input type="number" th:field="*{dieuKienKMBill}" class="form-control">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>Thời gian bắt đầu</label>
                                <input type="date" id="ngayBatDau" th:field="*{tgBatDau}" class="form-control">
                            </div>
                        </div>


                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>Thời gian kết thúc</label>
                                <input type="date" id="ngayKetThuc" th:field="*{tgKetThuc}" class="form-control">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>Số lượng đã dùng</label>
                                <input type="text" th:field="*{soLuongDaDung}" class="form-control" readonly>
                            </div>
                        </div>

                        <div class="col-lg-6 col-sm-6 col-12">
                            <div class="form-group">
                                <label>Mô tả</label>
                                <input type="text" th:field="*{moTa}" class="form-control">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-12">
                    <button class="btn btn-submit me-2"
                            th:formaction="@{'/manage/khuyen-mai/update/' + ${updateKhuyenMai.idKM}}">Update
                    </button>
                    <a href="/manage/khuyen-mai" class="btn btn-cancel">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</form>

<script src="/js/jquery-3.6.0.min.js"></script>

<script src="/js/feather.min.js"></script>

<script src="/js/jquery.slimscroll.min.js"></script>

<script src="/js/jquery.dataTables.min.js"></script>
<script src="/js/dataTables.bootstrap4.min.js"></script>

<script src="/js/bootstrap.bundle.min.js"></script>

<script src="/plugins/select2/js/select2.min.js"></script>

<script src="/plugins/sweetalert/sweetalert2.all.min.js"></script>
<script src="/plugins/sweetalert/sweetalerts.min.js"></script>

<script src="/js/script.js"></script>
<script src="/plugins/alertify/custom-alertify.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/AlertifyJS/1.13.1/alertify.min.js"></script>
<script>
    // Validate
    function validateKhuyenMaiForm() {
        var maKM = document.forms["khuyenMaiForm"]["maKM"].value;
        var tenKM = document.forms["khuyenMaiForm"]["tenKM"].value;
        var giaTienGiam = document.forms["khuyenMaiForm"]["giaTienGiam"].value;
        var thoiGianBatDau = document.forms["khuyenMaiForm"]["tgBatDau"].value;
        var thoiGianKetThuc = document.forms["khuyenMaiForm"]["tgKetThuc"].value;
        var dieuKienKM = document.forms["khuyenMaiForm"]["dieuKienKMBill"].value;
        var soLuong = document.forms["khuyenMaiForm"]["soLuong"].value;

        if (maKM === "") {
            Swal.fire("Không để trống Mã Khuyến Mãi");
            return false;
        }

        if (!maKM.match(/^[a-zA-Z0-9]+$/)) {
            Swal.fire("Mã Khuyến Mãi chỉ chứa chữ cái và số")
            return false;
        }

        if (tenKM === "") {
            Swal.fire("Không để trống Tên Khuyến Mãi");
            return false;
        }

        if (giaTienGiam === "") {
            Swal.fire("Không để trống Giá Tiền Giảm");
            return false;
        }

        if (giaTienGiam <= 1000) {
            Swal.fire("Giá Tiền Giảm phải > 1.000 VND");
            return false;
        }

        if (!giaTienGiam.match(/^[0-9]+$/)) {
            Swal.fire("Giá Tiền Giảm chỉ chứa số")
            return false;
        }

        const ngayBD = document.getElementById('ngayBatDau').value;
        const ngayKT = document.getElementById('ngayKetThuc').value;

        if (ngayBD > ngayKT){
            Swal.fire("Thời Gian Bắt Đầu phải nhỏ hơn Thời Gian Kết Thúc")
            return false;
        }

        if (thoiGianBatDau === "") {
            Swal.fire("Không để trống Thời Gian Bắt Đầu");
            return false;
        }

        if (thoiGianKetThuc === "") {
            Swal.fire("Không để trống Thời Gian Kết Thúc");
            return false;
        }

        if (thoiGianBatDau > thoiGianKetThuc){
            Swal.fire("Thời Gian Bắt Đầu phải nhỏ hơn Thời Gian Kết Thúc")
        }

        if (dieuKienKM === "") {
            Swal.fire("Không để trống Điều Kiện Khuyến Mãi");
            return false;
        }

        if (!dieuKienKM.match(/^[0-9]+$/)) {
            Swal.fire("Điều Kiện Khuyến Mãi chỉ chứa số")
            return false;
        }
        if (soLuong === "") {
            Swal.fire("Không để trống Số lượng");
            return false;
        }

        if (!soLuong.match(/^[0-9]+$/)) {
            Swal.fire("Số lượng chỉ chứa số")
            return false;
        }

        return true
    }
</script>
</body>
</html>